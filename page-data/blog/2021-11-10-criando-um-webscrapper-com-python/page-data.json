{"componentChunkName":"component---src-templates-post-tsx","path":"/blog/2021-11-10-criando-um-webscrapper-com-python/","result":{"data":{"site":{"siteMetadata":{"title":"Jorge.Room"}},"markdownRemark":{"id":"67d1c0fc-677d-52d1-8a6b-67aca49f6fb0","html":"<p>Neste tutorial vamos criar um webscrapper usando Python, usando as libs BeautifulSoup4 e requests. E no fim do tutorial vamos salvar essas informações em um banco de dados mongodb e em um arquivo do tipo JSON. Assim como algumas configurações adcionais que precisaram ser feitas para o uso do MongoDB Atlas.</p>\n<h2 id=\"sumário\" style=\"position:relative;\"><a href=\"#sum%C3%A1rio\" aria-label=\"sumário permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Sumário</h2>\n<ol>\n<li><a href=\"#criando-o-reposit%C3%B3rio\">Criando o Repositório</a></li>\n<li><a href=\"#instalando-depend%C3%AAncias\">Instalando Dependências</a></li>\n<li><a href=\"#baixando-a-p%C3%A1gina\">Baixando a Página</a></li>\n<li><a href=\"#navegando-pelas-p%C3%A1ginas\">Navegando pelas Páginas</a></li>\n<li><a href=\"#salvando-os-dados\">Salvando os Dados</a></li>\n<li><a href=\"#enviando-para-o-banco-de-dados\">Enviando para o Banco de Dados</a></li>\n<li><a href=\"#disposi%C3%A7%C3%B5es-finais\">Disposições Finais</a></li>\n</ol>\n<h2 id=\"criando-o-repositório\" style=\"position:relative;\"><a href=\"#criando-o-reposit%C3%B3rio\" aria-label=\"criando o repositório permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Criando o Repositório</h2>\n<p>Para iniciar, vamos criar nosso repositório. Para este simples projetos vamos precisar apenas de dois arquivos, <strong>requirements.txt</strong> onde iremos colocar as dependencias para facilitar a instalações posteriores <em>(útil para conteinerização),</em> e o arquivo com o código do scrapper, podemos chamar de <strong>main.py</strong>. Logo se em ambiente linux podemos lançar o seguinte comando no terminal:</p>\n<deckgo-highlight-code language=\"shell\"  >\n          <code slot=\"code\">mkdir scrapper &amp;&amp; touch scrapper/requirements.txt &amp;&amp; touch scrapper/main.py</code>\n        </deckgo-highlight-code>\n<p>E abrir no seu editor de preferencia, como estou usando o vscode, apenas o comando <code class=\"language-text\">code scrapper</code> basta. Caso não esteja em ambiente linux, basta criar os arquivos manualmente.</p>\n<h2 id=\"instalando-dependências\" style=\"position:relative;\"><a href=\"#instalando-depend%C3%AAncias\" aria-label=\"instalando dependências permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Instalando Dependências</h2>\n<p>Vamos adcionar a nossa lista de dependencia o <strong>BeautifulSoup4</strong> e <strong>Requests</strong> acrescentando elas no nosso arquivo requirements.txt, logo este arquivo ficará como a seguir.</p>\n<deckgo-highlight-code language=\"python\"  >\n          <code slot=\"code\">requests\nbeautifulsoup4</code>\n        </deckgo-highlight-code>\n<p>Em seguida para instalar essas dependencias basta dar o comando <code class=\"language-text\">pip install -r requirements.txt</code>, note que estamos usando o <a href=\"https://pypi.org/\">pip</a> para gerenciar nossas dependencias, se não tiver o pip instalado recomendo que o <a href=\"https://pip.pypa.io/en/stable/installation/\">instale</a>.</p>\n<p>Com isso todas as dependências que precisamos até então estão supridas.</p>\n<h2 id=\"baixando-a-página\" style=\"position:relative;\"><a href=\"#baixando-a-p%C3%A1gina\" aria-label=\"baixando a página permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Baixando a Página</h2>\n<p>Vamos pro nosso código em <code class=\"language-text\">main.py</code> e vamos começar a pegar os dados da página da seguinte forma:</p>\n<p><em>Como exemplo, minha página alvo é a página com o significado de amor, e meu objetivo é capturar os significados dessa palavra, exemplos e frases com essa palavra que estão na página.</em></p>\n<deckgo-highlight-code language=\"python\"  >\n          <code slot=\"code\"># Importando as dependências necessárias.\nimport requests\nfrom bs4 import BeautifulSoup\n\n# Definindo nossa url alvo.\nurl = &quot;https://www.dicio.com.br/amor/&quot;\n\n# Baixando a página\npage = requests.get(url)\n\n# Formatando a página com BeautifulSoup4\nbeautiful_page = BeautifulSoup(page.text, &#39;html.parser&#39;)</code>\n        </deckgo-highlight-code>\n<p>Com isso já podemos navegar sobre a página.</p>\n<h2 id=\"navegando-pelas-páginas\" style=\"position:relative;\"><a href=\"#navegando-pelas-p%C3%A1ginas\" aria-label=\"navegando pelas páginas permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Navegando pelas Páginas</h2>\n<p>Abra a página com seu navegador e inspecione a, procurando seus atributos, no caso do significado podemos selecionar todos os elementos do tipo spans que possuam o atributo itemprop=“description”.</p>\n<p><img src=\"/images/uploads/screenshot-from-2021-11-10-15-13-00.png\" alt=\"Procurando o elemento.\" title=\"Procurando o elemento.\"></p>\n<p>Para selecionar estes elementos vamos fazer da seguinte forma:</p>\n<deckgo-highlight-code language=\"python\"  >\n          <code slot=\"code\"># Importando as dependências necessárias.\nimport requests\nfrom bs4 import BeautifulSoup\n\n# Definindo nossa url alvo.\nurl = &quot;https://www.dicio.com.br/vida/&quot;\n\n# Baixando a página\npage = requests.get(url)\n\n# Formatando a página com BeautifulSoup4\nbeautiful_page = BeautifulSoup(page.text, &#39;html.parser&#39;)\n\n# Capturando o elemento que possue a definição da palavra.\ndefinition = beautiful_page.find(attrs={&#39;itemprop&#39;: &#39;description&#39;})</code>\n        </deckgo-highlight-code>\n<p>Se rodarmos esse código printando a definition devemos ter o seguinte resultado:</p>\n<p><img src=\"/images/uploads/screenshot-from-2021-11-10-15-14-00.png\" alt=\"Elemento capturado.\" title=\"Elemento capturado.\"></p>\n<p>O que é o que precisamos, mas para ficar melhor vamos todas as definições em um vetor, com uma definição para cada índice. Para isso podemos iterar sobre todos os spans que existem nesse elemento e inserir cada um em um vetor, da seguinte forma:</p>\n<deckgo-highlight-code language=\"python\"  >\n          <code slot=\"code\"># Importando as dependências necessárias.\nimport requests\nfrom bs4 import BeautifulSoup\n\n# Definindo nossa url alvo.\nurl = &quot;https://www.dicio.com.br/vida/&quot;\n\n# Baixando a página\npage = requests.get(url)\n\n# Formatando a página com BeautifulSoup4\nbeautiful_page = BeautifulSoup(page.text, &#39;html.parser&#39;)\n\n# Capturando o elemento que possue a definição da palavra.\ndefinition = beautiful_page.find(attrs={&#39;itemprop&#39;: &#39;description&#39;})\n\nstr_definition = []\n\n# Iterando sobre todos os elementos do tipo span encontrados.\nfor definition_i in definition.find_all(&#39;span&#39;):\n    try:\n        element_class = definition_i[&#39;class&#39;][0]\n    except:\n        element_class = &quot;&quot;\n    \n    # Evitando os elementos que possuem a classe tag, para evitar repetições.\n    if element_class != &#39;tag&#39;:\n        str_definition.append(definition_i.get_text().strip())</code>\n        </deckgo-highlight-code>\n<p>Se rodarmos nosso código agora vamos ter o seguinte resultado:</p>\n<p><img src=\"/images/uploads/screenshot-from-2021-11-10-15-20-11.png\" alt=\"Resultado de definicao.\" title=\"Resultado de definicao.\"></p>\n<p>É exatamente o que resultado que estávamos esperando, com isso podemos apenas repetir o processo para os elementos com os exemplos.</p>\n<deckgo-highlight-code language=\"python\"  >\n          <code slot=\"code\"># Importando as dependências necessárias.\nimport requests\nfrom bs4 import BeautifulSoup\n\n# Definindo nossa url alvo.\nurl = &quot;https://www.dicio.com.br/vida/&quot;\n\n# Baixando a página\npage = requests.get(url)\n\n# Formatando a página com BeautifulSoup4\nbeautiful_page = BeautifulSoup(page.text, &#39;html.parser&#39;)\n\n# Capturando o elemento que possue a definição da palavra.\ndefinition = beautiful_page.find(attrs={&#39;itemprop&#39;: &#39;description&#39;})\n\nstr_definition = []\n\n# Iterando sobre todos os elementos do tipo span encontrados.\nfor definition_i in definition.find_all(&#39;span&#39;):\n    try:\n        element_class = definition_i[&#39;class&#39;][0]\n    except:\n        element_class = &quot;&quot;\n    \n    # Evitando os elementos que possuem a classe tag, para evitar repetições.\n    if element_class != &#39;tag&#39;:\n        str_definition.append(definition_i.get_text().strip())\n\n# Nem sempre vamos ter disponível exemplos para todas as frases. Logo vamos usar um bloco try catch.\ntry:\n    # Buscar o elemento H3 com a classe &#39;tit-exemplo&#39;, onde os exemplos estarão na sua div pai. por isso o uso do .parent\n    example = beautiful_page.find(attrs={&#39;class&#39;: &#39;tit-exemplo&#39;}).parent.find_all(attrs={&#39;class&#39;: &#39;frase&#39;})\n    \n    str_example = []\n\n    # Iterar sobre os exemplos.\n    for example_i in example:\n        str_example.append(example_i.get_text().strip())\nexcept:\n    example = &quot;&quot;,\n    str_example = [],\n\n## Valor com o link da fonte das informações.\nsource = url</code>\n        </deckgo-highlight-code>\n<h2 id=\"salvando-os-dados\" style=\"position:relative;\"><a href=\"#salvando-os-dados\" aria-label=\"salvando os dados permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Salvando os Dados</h2>\n<p>Agora vamos formatar estes dados em um objeto para facilitar a manipulação. E então salvar em um arquivo tipo json.</p>\n<deckgo-highlight-code language=\"python\"  >\n          <code slot=\"code\"># Importando as dependências necessárias.\nimport requests\nfrom bs4 import BeautifulSoup\n\n# Definindo nossa url alvo.\nurl = &quot;https://www.dicio.com.br/vida/&quot;\n\n# Baixando a página\npage = requests.get(url)\n\n# Formatando a página com BeautifulSoup4\nbeautiful_page = BeautifulSoup(page.text, &#39;html.parser&#39;)\n\n# Capturando o elemento que possue a definição da palavra.\ndefinition = beautiful_page.find(attrs={&#39;itemprop&#39;: &#39;description&#39;})\n\nstr_definition = []\n\n# Iterando sobre todos os elementos do tipo span encontrados.\nfor definition_i in definition.find_all(&#39;span&#39;):\n    try:\n        element_class = definition_i[&#39;class&#39;][0]\n    except:\n        element_class = &quot;&quot;\n    \n    # Evitando os elementos que possuem a classe tag, para evitar repetições.\n    if element_class != &#39;tag&#39;:\n        str_definition.append(definition_i.get_text().strip())\n\n# Nem sempre vamos ter disponível exemplos para todas as frases. Logo vamos usar um bloco try catch.\ntry:\n    # Buscar o elemento H3 com a classe &#39;tit-exemplo&#39;, onde os exemplos estarão na sua div pai. por isso o uso do .parent\n    example = beautiful_page.find(attrs={&#39;class&#39;: &#39;tit-exemplo&#39;}).parent.find_all(attrs={&#39;class&#39;: &#39;frase&#39;})\n    \n    str_example = []\n\n    # Iterar sobre os exemplos.\n    for example_i in example:\n        str_example.append(example_i.get_text().strip())\nexcept:\n    example = &quot;&quot;,\n    str_example = [],\n\n## Valor com o link da fonte das informações.\nsource = url\n\n# Criando um objeto com todas as informações.\nresolve = {\n    &quot;word&quot;: &quot;amor&quot;,\n    &quot;definition&quot;: str_definition,\n    &quot;source&quot;: source,\n    &quot;example&quot;: str_example,\n    &quot;html&quot;: {\n        &quot;definition&quot;: str(definition),\n        &quot;example&quot;: str(example),\n    }\n}\n\n# Escrevendo em um objeto tipo json guardando o nosso objeto.\nf = open(&quot;significado_de_amor.json&quot;, &quot;a&quot;)\n\nf.write(str(resolve).replace(&#39;&quot;&#39;, &quot;`&quot;).replace(&quot;&#39;&quot;, &#39;&quot;&#39;).replace(&quot;`&quot;, &quot;&#39;&quot;))\n\nf.write(&#39;,\\n&#39;)</code>\n        </deckgo-highlight-code>\n<p>Se rodarmos o nosso código agora, ele irá criar um arquivo chamado “significado_de_amor.json” com o nosso objeto salvo.</p>\n<deckgo-highlight-code language=\"json\"  >\n          <code slot=\"code\">{\n    &quot;word&quot;: &quot;amor&quot;,\n    &quot;definition&quot;: [\n        &quot;substantivo feminino&quot;,\n        &quot;Conjunto dos hábitos e costumes de alguém; maneira de viver: tinha uma vida de milionário.&quot;,\n        &quot;Reunião daquilo que diferencia um corpo vivo do morto: encontrou o acidentado sem vida; a planta amanheceu sem vida.&quot;,\n        &quot;O que define um organismo do seu nascimento até a morte: a vida dos animais.&quot;,\n        &quot;[Por Extensão] Tempo que um ser existe, entre o seu nascimento e a sua morte; existência: já tinha alguns anos de vida.&quot;,\n        &quot;[Por Extensão] Fase específica dentro dessa existência: vida adulta.&quot;,\n        &quot;[Figurado] Tempo de duração de alguma coisa: a vida de um carro.&quot;,\n        &quot;[Por Extensão] Reunião dos seres caracterizados tendo em conta sua espécie, ambiente, época: vida terrestre; vida marítima.&quot;,\n        &quot;[Figurado] Aquilo que dá vigor ou sentido à existência de alguém; espírito: a música é minha vida!&quot;,\n        &quot;Reunião dos fatos e acontecimentos mais relevantes na existência de alguém; biografia: descrevia a vida do cantor.&quot;,\n        &quot;O que uma pessoa faz para sobreviver: precisava trabalhar para ganhar a vida.&quot;,\n        &quot;[Figurado] O que se realiza; prática: vida rural.&quot;,\n        &quot;Etimologia (origem da palavra vida). Do latim vita.ae.&quot;\n    ],\n    &quot;source&quot;: &quot;https://www.dicio.com.br/vida/&quot;,\n    &quot;example&quot;: [\n        &quot;No início de 2009, os departamentos foram cenários de prolongados e inéditos protestos de caráter social, com o registro de alguns episódios de violência, por causa do aumento do custo de vida. Folha de S.Paulo, 26/06/2009&quot;,\n        &quot;O ex-presidente vinha mantendo uma vida discreta desde que passou o poder a Barack Obama, em janeiro. Folha de S.Paulo, 25/10/2009&quot;,\n        &quot;O teclado é iluminado, o que facilita a vida de quem precisa usar o computador em ambientes escuros. Folha de S.Paulo, 15/07/2009&quot;\n    ],\n    &quot;html&quot;: {\n        &quot;definition&quot;: &quot;&lt;p class=&#39;significado textonovo&#39; itemprop=&#39;description&#39;&gt;&lt;span class=&#39;cl&#39;&gt;substantivo feminino&lt;/span&gt; &lt;span&gt;Conjunto dos hábitos e costumes de alguém; maneira de viver: tinha uma vida de milionário.&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Reunião daquilo que diferencia um corpo vivo do morto: encontrou o acidentado sem vida; a planta amanheceu sem vida.&lt;/span&gt;&lt;br/&gt;&lt;span&gt;O que define um organismo do seu nascimento até a morte: a vida dos animais.&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span class=&#39;tag&#39;&gt;[Por Extensão]&lt;/span&gt; Tempo que um ser existe, entre o seu nascimento e a sua morte; existência: já tinha alguns anos de vida.&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span class=&#39;tag&#39;&gt;[Por Extensão]&lt;/span&gt; Fase específica dentro dessa existência: vida adulta.&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span class=&#39;tag&#39;&gt;[Figurado]&lt;/span&gt; Tempo de duração de alguma coisa: a vida de um carro.&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span class=&#39;tag&#39;&gt;[Por Extensão]&lt;/span&gt; Reunião dos seres caracterizados tendo em conta sua espécie, ambiente, época: vida terrestre; vida marítima.&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span class=&#39;tag&#39;&gt;[Figurado]&lt;/span&gt; Aquilo que dá vigor ou sentido à existência de alguém; espírito: a música é minha vida!&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Reunião dos fatos e acontecimentos mais relevantes na existência de alguém; biografia: descrevia a vida do cantor.&lt;/span&gt;&lt;br/&gt;&lt;span&gt;O que uma pessoa faz para sobreviver: precisava trabalhar para ganhar a vida.&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span class=&#39;tag&#39;&gt;[Figurado]&lt;/span&gt; O que se realiza; prática: vida rural.&lt;/span&gt;&lt;br/&gt;&lt;span class=&#39;etim&#39;&gt;Etimologia (origem da palavra &lt;i&gt;vida&lt;/i&gt;). Do latim vita.ae.&lt;/span&gt;&lt;/p&gt;&quot;,\n        &quot;example&quot;: &quot;[&lt;div class=&#39;frase&#39;&gt;\\n                            No início de 2009, os departamentos foram cenários de prolongados e inéditos protestos de caráter social, com o registro de alguns episódios de violência, por causa do aumento do custo de &lt;strong&gt;vida&lt;/strong&gt;. &lt;em&gt;Folha de S.Paulo, 26/06/2009&lt;/em&gt; &lt;/div&gt;, &lt;div class=&#39;frase&#39;&gt;\\n                            O ex-presidente vinha mantendo uma &lt;strong&gt;vida&lt;/strong&gt; discreta desde que passou o poder a Barack Obama, em janeiro. &lt;em&gt;Folha de S.Paulo, 25/10/2009&lt;/em&gt; &lt;/div&gt;, &lt;div class=&#39;frase&#39;&gt;\\n                            O teclado é iluminado, o que facilita a &lt;strong&gt;vida&lt;/strong&gt; de quem precisa usar o computador em ambientes escuros. &lt;em&gt;Folha de S.Paulo, 15/07/2009&lt;/em&gt; &lt;/div&gt;]&quot;\n    }\n},</code>\n        </deckgo-highlight-code>\n<h2 id=\"enviando-para-o-banco-de-dados\" style=\"position:relative;\"><a href=\"#enviando-para-o-banco-de-dados\" aria-label=\"enviando para o banco de dados permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Enviando para o Banco de Dados</h2>\n<p>Estarei salvando estes dados em um banco de dados mongodb, usando o <a href=\"https://www.mongodb.com/atlas-signup-from-mlab\">atlas</a>, e como recomendação, adcionarei a lista de requirements as dependências <code class=\"language-text\">pymongo</code> e <code class=\"language-text\">dnspython</code>.</p>\n<p>Vamos definir um método para instanciar a nossa conexão com o banco de dados, que pode ser dita da seguinte forma:</p>\n<deckgo-highlight-code language=\"python\"  >\n          <code slot=\"code\">from pymongo import MongoClient\nimport pymongo\n\ndef get_database():\n    from pymongo import MongoClient\n    import pymongo\n\n    # Prover a url de conexão do atlas para usar com o pymongo\n    CONNECTION_STRING = &quot;mongodb+srv://[usuario]:[senha]@[dominio].mongodb.net/[database]retryWrites=true&amp;w=majority&quot;\n\n    # Criar a conexão usando o MongoClient. Pode ser feita importando o MongoClient ou usando pymongo.MongoClient\n    from pymongo import MongoClient\n    client = MongoClient(CONNECTION_STRING)\n\n    # Criar o banco de dados ou usar o seguinte banco.\n    return client[&#39;scrapper_database&#39;]</code>\n        </deckgo-highlight-code>\n<p>Você também pode conseguir a url de conexão usando o próprio site do atlas se estiver usando. Clique no botão <code class=\"language-text\">connect</code> ainda na aba de overview, deve estar no canto direito da tela.</p>\n<p><img src=\"/images/uploads/screenshot-from-2021-11-17-09-27-20.png\" alt=\"Botao connect.\" title=\"Botao connect.\"></p>\n<p>E então clique na opção <code class=\"language-text\">Connect Your Application</code>.</p>\n<p><img src=\"/images/uploads/screenshot-from-2021-11-17-09-27-36.png\" alt=\"Botao Connect Your Application\" title=\"Botao Connect Your Application\"></p>\n<p>Assim você pode copiar a url do banco e apenas substituir o usuario, senha e banco de dados que deseja usar.</p>\n<p><img src=\"/images/uploads/screenshot-from-2021-11-17-09-27-54.png\" alt=\"url do banco.\" title=\"url do banco.\"></p>\n<p>Substituindo respectivamente <username> com seu nome de usuário, <password> com a senha desse usuário e <code class=\"language-text\">myFirstDatabase</code> com o nome do banco de dados que se deseja utilizar.</p>\n<p>Se estiver tendo problema de conexão, procure acessar  a aba de <code class=\"language-text\">Network Access</code> em <code class=\"language-text\">Security</code> e adcione o ip <code class=\"language-text\">0.0.0.0/0</code> e tente novamente. Isso libera conexão de todos os IPs para o banco então use com cautela.</p>\n<p><img src=\"/images/uploads/screenshot-from-2021-11-17-09-38-57.png\" alt=\"Aba de Segurança\" title=\"Aba de Segurança\"></p>\n<p><img src=\"/images/uploads/screenshot-from-2021-11-17-09-37-23.png\" alt=\"Adcionando o IP.\" title=\"Adcionando o IP.\"></p>\n<p>Se ainda não tiver usuário de banco no atlas, crie um novo usuário na aba <code class=\"language-text\">Database Access</code>.</p>\n<p>Assim podemos usar-lo para enviar os dados, podemos definir a coleção que queremos usar como a seguir.</p>\n<deckgo-highlight-code language=\"python\"  >\n          <code slot=\"code\">dbname = get_database()\nscrapper_collection = dbname[&quot;scrapper_collection&quot;]</code>\n        </deckgo-highlight-code>\n<p>E então para enviar os dados basta usar a função insert enviando nosso objeto <code class=\"language-text\">resolve</code>.</p>\n<deckgo-highlight-code language=\"python\"  >\n          <code slot=\"code\">scrapper_collection.insert_one(resolve)</code>\n        </deckgo-highlight-code>\n<p>No fim, nosso código completo estará assim.</p>\n<deckgo-highlight-code language=\"python\"  >\n          <code slot=\"code\"># Importando as dependências necessárias.\nimport requests\nfrom bs4 import BeautifulSoup\n\n\nfrom pymongo import MongoClient\nimport pymongo\n\ndef get_database():\n    from pymongo import MongoClient\n    import pymongo\n\n    # Prover a url de conexão do atlas para usar com o pymongo\n    CONNECTION_STRING = &quot;mongodb+srv://[usuario]:[senha]@[dominio].mongodb.net/[database]retryWrites=true&amp;w=majority&quot;\n\n    # Criar a conexão usando o MongoClient. Pode ser feita importando o MongoClient ou usando pymongo.MongoClient\n    from pymongo import MongoClient\n    client = MongoClient(CONNECTION_STRING)\n\n    # Criar o banco de dados ou usar o seguinte banco.\n    return client[&#39;scrapper_database&#39;]\n\ndbname = get_database()\nscrapper_collection = dbname[&quot;scrapper_collection&quot;]\n\n# Definindo nossa url alvo.\nurl = &quot;https://www.dicio.com.br/vida/&quot;\n\n# Baixando a página\npage = requests.get(url)\n\n# Formatando a página com BeautifulSoup4\nbeautiful_page = BeautifulSoup(page.text, &#39;html.parser&#39;)\n\n# Capturando o elemento que possue a definição da palavra.\ndefinition = beautiful_page.find(attrs={&#39;itemprop&#39;: &#39;description&#39;})\n\nstr_definition = []\n\n# Iterando sobre todos os elementos do tipo span encontrados.\nfor definition_i in definition.find_all(&#39;span&#39;):\n    try:\n        element_class = definition_i[&#39;class&#39;][0]\n    except:\n        element_class = &quot;&quot;\n    \n    # Evitando os elementos que possuem a classe tag, para evitar repetições.\n    if element_class != &#39;tag&#39;:\n        str_definition.append(definition_i.get_text().strip())\n\n# Nem sempre vamos ter disponível exemplos para todas as frases. Logo vamos usar um bloco try catch.\ntry:\n    # Buscar o elemento H3 com a classe &#39;tit-exemplo&#39;, onde os exemplos estarão na sua div pai. por isso o uso do .parent\n    example = beautiful_page.find(attrs={&#39;class&#39;: &#39;tit-exemplo&#39;}).parent.find_all(attrs={&#39;class&#39;: &#39;frase&#39;})\n    \n    str_example = []\n\n    # Iterar sobre os exemplos.\n    for example_i in example:\n        str_example.append(example_i.get_text().strip())\nexcept:\n    example = &quot;&quot;,\n    str_example = [],\n\n## Valor com o link da fonte das informações.\nsource = url\n\n# Criando um objeto com todas as informações.\nresolve = {\n    &quot;word&quot;: &quot;amor&quot;,\n    &quot;definition&quot;: str_definition,\n    &quot;source&quot;: source,\n    &quot;example&quot;: str_example,\n    &quot;html&quot;: {\n        &quot;definition&quot;: str(definition),\n        &quot;example&quot;: str(example),\n    }\n}\n\n# Escrevendo em um objeto tipo json guardando o nosso objeto.\nf = open(&quot;significado_de_amor.json&quot;, &quot;a&quot;)\n\nf.write(str(resolve).replace(&#39;&quot;&#39;, &quot;`&quot;).replace(&quot;&#39;&quot;, &#39;&quot;&#39;).replace(&quot;`&quot;, &quot;&#39;&quot;))\n\nf.write(&#39;,\\n&#39;)\n\nf.close()\n\n# Salvar o objeto em banco de dados.\nscrapper_collection.insert_one(resolve)</code>\n        </deckgo-highlight-code>\n<p>Rodando nosso código teremos o seguinte resultado, ele irá salvar o objeto <code class=\"language-text\">resolve</code> em um arquivo do tipo json e também irá salvar em um banco de dados do atlas usando a database <code class=\"language-text\">scrapper_database</code> na coleção <code class=\"language-text\">scrapper_collection</code>, como a seguir:</p>\n<p><img src=\"/images/uploads/screenshot-from-2021-11-17-09-22-40.png\" alt=\"Banco de dados MongoDB com a coleçao.\" title=\"Banco de dados MongoDB com a coleçao.\"></p>\n<h2 id=\"disposições-finais\" style=\"position:relative;\"><a href=\"#disposi%C3%A7%C3%B5es-finais\" aria-label=\"disposições finais permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Disposições Finais</h2>\n<p>Web Scrapping nunca foi tão fácil e em pouco tempo é possivel escrever um código capaz de fazer o tal, neste caso escolhi usar python, mas em outro momento também já o fiz usando javascript e não tem segredo. Contanto que não precise lidar com sistemas de anti-bot ou captchas é bem fácil de realizar. Mas caso tenha ainda é possível, só é um pouco mais complicado.</p>\n<p>Quando escrevia este post me deparei com um repositório bem interessante quando temos que lidar com sites com detecção de bots. Vale a pena dar uma lida em <a href=\"https://github.com/niespodd/browser-fingerprinting\">Avoiding bot detection</a> para termos mais sucesso em diversos cenários.</p>\n<p><a href=\"https://github.com/Jorgen-Jr/scrapper_tutorial\">O código fonte usado neste tutorial pode ser acessado aqui.</a></p>","excerpt":"Neste tutorial vamos criar um webscrapper usando Python, usando as libs BeautifulSoup4 e requests. E no fim do tutorial vamos salvar essas informações em um banco de dados mongodb e em um arquivo do tipo JSON. Assim como algumas configurações…","frontmatter":{"cover":"/images/uploads/iceland-2608985_960_720.webp","date":"17/11/2021 15:40","isBanner":false,"layout":"post","special":false,"title":"Criando um WebScrapper com Python"},"fields":{"slug":"/blog/2021-11-10-criando-um-webscrapper-com-python/"}},"count":{"totalCount":10},"previous":{"fields":{"slug":"/blog/2021-10-20-desenvolvendo-um-bot-para-o-telegram-usando-netlify-functions/"},"frontmatter":{"title":"Desenvolvendo um Bot para o Telegram usando Netlify Functions"}},"next":{"fields":{"slug":"/blog/2021-12-15-recursos-grátis-para-desenvolvimento-web/"},"frontmatter":{"title":"Recursos Grátis para Desenvolvimento Web"}}},"pageContext":{"id":"67d1c0fc-677d-52d1-8a6b-67aca49f6fb0","date":"2021-11-17","previousPostId":"f8f10298-5d6a-5b84-9b95-b247b398a17d","nextPostId":"669957bf-1134-576c-9e00-88eaaa4a568e"}},"staticQueryHashes":["712016698"],"slicesMap":{}}